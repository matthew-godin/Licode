import { createHash } from "https://deno.land/std/hash/mod.ts";
export function i2osp(x, length) {
    const t = new Uint8Array(length);
    for (let i = length - 1; i >= 0; i--) {
        if (x === 0n)
            break;
        t[i] = Number(x & 255n);
        x = x >> 8n;
    }
    return t;
}
export function os2ip(m) {
    let n = 0n;
    for (const c of m)
        n = (n << 8n) + BigInt(c);
    return n;
}
export function mgf1(seed, length, hash) {
    let counter = 0n;
    let output = [];
    while (output.length < length) {
        let h;
        const c = i2osp(counter, 4);
        if (typeof hash === 'function') {
            h = hash(new Uint8Array([...seed, ...c]));
        }
        else {
            h = new Uint8Array(createHash(hash).update(new Uint8Array([...seed, ...c])).digest());
        }
        output = [...output, ...h];
        counter++;
    }
    return new Uint8Array(output.slice(0, length));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJpbWl0aXZlcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImh0dHBzOi8vZGVuby5sYW5kL3gvZ29kX2NyeXB0b0B2MC4yLjAvc3JjL3ByaW1pdGl2ZXMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLG1DQUFtQyxDQUFDO0FBVS9ELE1BQU0sVUFBVSxLQUFLLENBQUMsQ0FBUyxFQUFFLE1BQWM7SUFDN0MsTUFBTSxDQUFDLEdBQUcsSUFBSSxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDakMsS0FBSSxJQUFJLENBQUMsR0FBRyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDbkMsSUFBSSxDQUFDLEtBQUssRUFBRTtZQUFFLE1BQU07UUFDcEIsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLE1BQU0sQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7UUFDeEIsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7S0FDYjtJQUVELE9BQU8sQ0FBQyxDQUFDO0FBQ1gsQ0FBQztBQUVELE1BQU0sVUFBVSxLQUFLLENBQUMsQ0FBYTtJQUNqQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDWCxLQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUM7UUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzVDLE9BQU8sQ0FBQyxDQUFDO0FBQ1gsQ0FBQztBQVVELE1BQU0sVUFBVSxJQUFJLENBQUMsSUFBZ0IsRUFBRSxNQUFjLEVBQUUsSUFBa0M7SUFDdkYsSUFBSSxPQUFPLEdBQUcsRUFBRSxDQUFDO0lBQ2pCLElBQUksTUFBTSxHQUFhLEVBQUUsQ0FBQztJQUUxQixPQUFNLE1BQU0sQ0FBQyxNQUFNLEdBQUcsTUFBTSxFQUFFO1FBQzVCLElBQUksQ0FBQyxDQUFDO1FBQ04sTUFBTSxDQUFDLEdBQUcsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQztRQUU1QixJQUFJLE9BQU8sSUFBSSxLQUFLLFVBQVUsRUFBRTtZQUM5QixDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksVUFBVSxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7U0FDMUM7YUFBTTtZQUNMLENBQUMsR0FBRyxJQUFJLFVBQVUsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLElBQUksVUFBVSxDQUFDLENBQUMsR0FBRyxJQUFJLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQztTQUN2RjtRQUVELE1BQU0sR0FBRyxDQUFDLEdBQUcsTUFBTSxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDM0IsT0FBTyxFQUFFLENBQUM7S0FDWDtJQUVELE9BQU8sSUFBSSxVQUFVLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztBQUNqRCxDQUFDIn0=